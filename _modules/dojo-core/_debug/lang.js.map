{"version":3,"file":"lang.js","sourceRoot":"","sources":["lang.ts"],"names":["isObject","copyArray","copy","create","duplicate","getPropertyNames","getPropertyDescriptor","isIdentical","lateBind","observe","partial"],"mappings":"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","sourcesContent":["import { PropertyEvent, Observer } from './observers/interfaces';\nimport * as ObjectObserver from './observers/ObjectObserver';\nimport has from './has';\n\nconst slice = Array.prototype.slice;\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isObject(item: any): boolean {\n\treturn item && typeof item === 'object' && !Array.isArray(item) && !(item instanceof RegExp);\n}\n\nfunction copyArray(array: any[], kwArgs: CopyArgs): any[] {\n\treturn array.map(function (item: any): any {\n\t\tif (Array.isArray(item)) {\n\t\t\treturn copyArray(item, kwArgs);\n\t\t}\n\n\t\treturn isObject(item) ?\n\t\t\tcopy({\n\t\t\t\tsources: [ item ],\n\t\t\t\tdeep: kwArgs.deep,\n\t\t\t\tdescriptors: kwArgs.descriptors,\n\t\t\t\tinherited: kwArgs.inherited,\n\t\t\t\tassignPrototype: kwArgs.assignPrototype\n\t\t\t}) :\n\t\t\titem;\n\t});\n}\n\nexport function copy(kwArgs: CopyArgs): any {\n\tlet target: any;\n\tlet sources: any[] = kwArgs.sources;\n\n\tif (!sources.length) {\n\t\tthrow new RangeError('lang.copy requires at least one source object.');\n\t}\n\n\tif (kwArgs.assignPrototype) {\n\t\t// create from the same prototype\n\t\ttarget = Object.create(Object.getPrototypeOf(sources[0]));\n\t}\n\telse {\n\t\t// use the target or create a new object\n\t\ttarget = kwArgs.target || {};\n\t}\n\n\tfor (let i = 0; i < sources.length; i++) {\n\t\t// iterate through all the sources\n\t\tconst source: { [index: string]: any } = sources[i];\n\t\tlet name: string;\n\t\tlet value: any;\n\n\t\tif (kwArgs.descriptors) {\n\t\t\t// if we are copying descriptors, use to get{Own}PropertyNames so we get every property\n\t\t\t// (including non enumerables).\n\t\t\tconst names = (kwArgs.inherited ? getPropertyNames : Object.getOwnPropertyNames)(source);\n\n\t\t\tfor (let j = 0; j < names.length; j++) {\n\t\t\t\tname = names[j];\n\t\t\t\t// get the descriptor\n\t\t\t\tconst descriptor = (kwArgs.inherited ?\n\t\t\t\t\tgetPropertyDescriptor : Object.getOwnPropertyDescriptor)(source, name);\n\t\t\t\tvalue = descriptor.value;\n\n\t\t\t\tif (kwArgs.deep) {\n\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\tdescriptor.value = copyArray(value, kwArgs);\n\t\t\t\t\t}\n\t\t\t\t\telse if (isObject(value)) {\n\t\t\t\t\t\tdescriptor.value = copy({\n\t\t\t\t\t\t\tsources: [ value ],\n\t\t\t\t\t\t\tdeep: true,\n\t\t\t\t\t\t\tdescriptors: true,\n\t\t\t\t\t\t\tinherited: kwArgs.inherited,\n\t\t\t\t\t\t\tassignPrototype: kwArgs.assignPrototype\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// and copy to the target\n\t\t\t\tObject.defineProperty(target, name, descriptor);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// If we aren't using descriptors, we use a standard for-in to simplify skipping\n\t\t\t// non-enumerables and inheritance. We could use Object.keys when we aren't inheriting.\n\t\t\tfor (name in source) {\n\t\t\t\tif (kwArgs.inherited || hasOwnProperty.call(source, name)) {\n\t\t\t\t\tvalue = source[name];\n\n\t\t\t\t\tif (kwArgs.deep) {\n\t\t\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\t\t\tvalue = copyArray(value, kwArgs);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (isObject(value)) {\n\t\t\t\t\t\t\tvalue = copy({\n\t\t\t\t\t\t\t\tsources: [ value ],\n\t\t\t\t\t\t\t\tdeep: true,\n\t\t\t\t\t\t\t\tinherited: kwArgs.inherited,\n\t\t\t\t\t\t\t\tassignPrototype: kwArgs.assignPrototype\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttarget[name] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn target;\n}\n\nexport interface CopyArgs {\n\tdeep?: boolean;\n\tdescriptors?: boolean;\n\tinherited?: boolean;\n\tassignPrototype?: boolean;\n\ttarget?: any;\n\tsources: any[];\n}\n\nexport function create(prototype: {}, ...mixins: {}[]): {} {\n\tif (!mixins.length) {\n\t\tthrow new RangeError('lang.create requires at least one mixin object.');\n\t}\n\n\treturn copy({\n\t\tassignPrototype: false,\n\t\tdeep: false,\n\t\tdescriptors: false,\n\t\tinherited: false,\n\t\ttarget: Object.create(prototype),\n\t\tsources: mixins\n\t});\n}\n\nexport function duplicate(source: {}): {} {\n\treturn copy({\n\t\tassignPrototype: true,\n\t\tdeep: true,\n\t\tdescriptors: true,\n\t\tsources: [ source ]\n\t});\n}\n\nexport function getPropertyNames(object: {}): string[] {\n\tlet setOfNames: { [index: string]: any } = {};\n\tlet names : string[] = [];\n\n\tdo {\n\t\t// go through each prototype to add the property names\n\t\tconst ownNames = Object.getOwnPropertyNames(object);\n\t\tfor (let i = 0, l = ownNames.length; i < l; i++) {\n\t\t\tconst name = ownNames[i];\n\t\t\t// check to make sure we haven't added it yet\n\t\t\tif (setOfNames[name] !== true) {\n\t\t\t\tsetOfNames[name] = true;\n\t\t\t\tnames.push(name);\n\t\t\t}\n\t\t}\n\t\tobject = Object.getPrototypeOf(object);\n\t}\n\twhile (object && object !== Object.prototype);\n\n\treturn names;\n}\n\nexport function getPropertyDescriptor(object: Object, property: string): PropertyDescriptor {\n\tlet descriptor: PropertyDescriptor;\n\tdo {\n\t\tdescriptor = Object.getOwnPropertyDescriptor(object, property);\n\t}\n\twhile (!descriptor && (object = Object.getPrototypeOf(object)));\n\n\treturn descriptor;\n}\n\nexport function isIdentical(a: any, b: any): boolean {\n\treturn a === b ||\n\t\t/* both values are NaN */\n\t\t(a !== a && b !== b);\n}\n\nexport function lateBind(instance: {}, method: string, ...suppliedArgs: any[]): (...args: any[]) => any {\n\treturn suppliedArgs.length ?\n\t\tfunction () {\n\t\t\tconst args: any[] = arguments.length ? suppliedArgs.concat(slice.call(arguments)) : suppliedArgs;\n\n\t\t\t// TS7017\n\t\t\treturn (<any> instance)[method].apply(instance, args);\n\t\t} :\n\t\tfunction () {\n\t\t\treturn (<any> instance)[method].apply(instance, arguments);\n\t\t};\n}\n\nexport function observe(kwArgs: ObserveArgs): Observer {\n\tlet Ctor = kwArgs.nextTurn && has('object-observe') ? ObjectObserver.Es7Observer : ObjectObserver.Es5Observer;\n\n\treturn new Ctor(kwArgs);\n}\n\nexport interface ObserveArgs {\n\tlistener: (events: PropertyEvent[]) => any;\n\tnextTurn?: boolean;\n\tonlyReportObserved?: boolean;\n\ttarget: {}\n}\n\nexport function partial(targetFunction: (...args: any[]) => any, ...suppliedArgs: any[]): (...args: any[]) => any {\n\treturn function () {\n\t\tconst args: any[] = arguments.length ? suppliedArgs.concat(slice.call(arguments)) : suppliedArgs;\n\n\t\treturn targetFunction.apply(this, args);\n\t};\n}\n"]}